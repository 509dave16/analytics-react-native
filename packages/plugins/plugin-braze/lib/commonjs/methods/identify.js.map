{"version":3,"sources":["identify.ts"],"names":["payload","userId","ReactAppboy","changeUser","traits","birthday","data","Date","setDateOfBirth","getFullYear","getMonth","getDate","email","setEmail","firstName","setFirstName","lastName","setLastName","gender","validGenders","isValidGender","indexOf","setGender","phone","setPhoneNumber","address","city","setHomeCity","country","setCountry","appBoyTraits","Object","entries","forEach","key","value","setCustomUserAttribute"],"mappings":";;;;;;;AAAA;;;;eAMgBA,OAAD,IAAgC;AAC7C,MAAIA,OAAO,CAACC,MAAZ,EAAoB;AAClBC,kCAAYC,UAAZ,CAAuBH,OAAO,CAACC,MAA/B;AACD;;AAED,MAAID,OAAO,CAACI,MAAR,CAAeC,QAAnB,EAA6B;AAC3B,UAAMC,IAAI,GAAG,IAAIC,IAAJ,CAASP,OAAO,CAACI,MAAR,CAAeC,QAAxB,CAAb;;AACAH,kCAAYM,cAAZ,CACEF,IAAI,CAACG,WAAL,EADF,EAEE;AACCH,IAAAA,IAAI,CAACI,QAAL,KAAkB,CAHrB,EAIEJ,IAAI,CAACK,OAAL,EAJF;AAMD;;AAED,MAAIX,OAAO,CAACI,MAAR,CAAeQ,KAAnB,EAA0B;AACxBV,kCAAYW,QAAZ,CAAqBb,OAAO,CAACI,MAAR,CAAeQ,KAApC;AACD;;AAED,MAAIZ,OAAO,CAACI,MAAR,CAAeU,SAAnB,EAA8B;AAC5BZ,kCAAYa,YAAZ,CAAyBf,OAAO,CAACI,MAAR,CAAeU,SAAxC;AACD;;AAED,MAAId,OAAO,CAACI,MAAR,CAAeY,QAAnB,EAA6B;AAC3Bd,kCAAYe,WAAZ,CAAwBjB,OAAO,CAACI,MAAR,CAAeY,QAAvC;AACD;;AAED,MAAIhB,OAAO,CAACI,MAAR,CAAec,MAAnB,EAA2B;AACzB,UAAMC,YAAY,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAArB;AACA,UAAMC,aAAa,GAAGD,YAAY,CAACE,OAAb,CAAqBrB,OAAO,CAACI,MAAR,CAAec,MAApC,IAA8C,CAAC,CAArE;;AACA,QAAIE,aAAJ,EAAmB;AACjBlB,oCAAYoB,SAAZ,CACEtB,OAAO,CAACI,MAAR,CAAec,MADjB;AAGD;AACF;;AAED,MAAIlB,OAAO,CAACI,MAAR,CAAemB,KAAnB,EAA0B;AACxBrB,kCAAYsB,cAAZ,CAA2BxB,OAAO,CAACI,MAAR,CAAemB,KAA1C;AACD;;AAED,MAAIvB,OAAO,CAACI,MAAR,CAAeqB,OAAnB,EAA4B;AAC1B,QAAIzB,OAAO,CAACI,MAAR,CAAeqB,OAAf,CAAuBC,IAA3B,EAAiC;AAC/BxB,oCAAYyB,WAAZ,CAAwB3B,OAAO,CAACI,MAAR,CAAeqB,OAAf,CAAuBC,IAA/C;AACD;;AACD,QAAI1B,OAAO,CAACI,MAAR,CAAeqB,OAAf,CAAuBG,OAA3B,EAAoC;AAClC1B,oCAAY2B,UAAZ,CAAuB7B,OAAO,CAACI,MAAR,CAAeqB,OAAf,CAAuBG,OAA9C;AACD;AACF;;AAED,QAAME,YAAY,GAAG,CACnB,UADmB,EAEnB,OAFmB,EAGnB,WAHmB,EAInB,UAJmB,EAKnB,QALmB,EAMnB,OANmB,EAOnB,SAPmB,CAArB;AAUAC,EAAAA,MAAM,CAACC,OAAP,CAAehC,OAAO,CAACI,MAAvB,EAA+B6B,OAA/B,CAAuC,QAAkB;AAAA,QAAjB,CAACC,GAAD,EAAMC,KAAN,CAAiB;;AACvD,QAAIL,YAAY,CAACT,OAAb,CAAqBa,GAArB,IAA4B,CAAhC,EAAmC;AACjChC,oCAAYkC,sBAAZ,CAAmCF,GAAnC,EAAwCC,KAAxC;AACD;AACF,GAJD;AAMA,SAAOnC,OAAP;AACD,C","sourcesContent":["import ReactAppboy, {\n  GenderTypes,\n  MonthsAsNumber,\n} from 'react-native-appboy-sdk';\nimport type { IdentifyEventType } from '@segment/analytics-react-native';\n\nexport default (payload: IdentifyEventType) => {\n  if (payload.userId) {\n    ReactAppboy.changeUser(payload.userId);\n  }\n\n  if (payload.traits.birthday) {\n    const data = new Date(payload.traits.birthday);\n    ReactAppboy.setDateOfBirth(\n      data.getFullYear(),\n      // getMonth is zero indexed\n      (data.getMonth() + 1) as MonthsAsNumber,\n      data.getDate()\n    );\n  }\n\n  if (payload.traits.email) {\n    ReactAppboy.setEmail(payload.traits.email);\n  }\n\n  if (payload.traits.firstName) {\n    ReactAppboy.setFirstName(payload.traits.firstName);\n  }\n\n  if (payload.traits.lastName) {\n    ReactAppboy.setLastName(payload.traits.lastName);\n  }\n\n  if (payload.traits.gender) {\n    const validGenders = ['m', 'f', 'n', 'o', 'p', 'u'];\n    const isValidGender = validGenders.indexOf(payload.traits.gender) > -1;\n    if (isValidGender) {\n      ReactAppboy.setGender(\n        payload.traits.gender as GenderTypes[keyof GenderTypes]\n      );\n    }\n  }\n\n  if (payload.traits.phone) {\n    ReactAppboy.setPhoneNumber(payload.traits.phone);\n  }\n\n  if (payload.traits.address) {\n    if (payload.traits.address.city) {\n      ReactAppboy.setHomeCity(payload.traits.address.city);\n    }\n    if (payload.traits.address.country) {\n      ReactAppboy.setCountry(payload.traits.address.country);\n    }\n  }\n\n  const appBoyTraits = [\n    'birthday',\n    'email',\n    'firstName',\n    'lastName',\n    'gender',\n    'phone',\n    'address',\n  ];\n\n  Object.entries(payload.traits).forEach(([key, value]) => {\n    if (appBoyTraits.indexOf(key) < 0) {\n      ReactAppboy.setCustomUserAttribute(key, value as any);\n    }\n  });\n\n  return payload;\n};\n"]}