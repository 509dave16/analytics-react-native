{"version":3,"sources":["identify.ts"],"names":["ReactAppboy","payload","userId","changeUser","traits","birthday","data","Date","setDateOfBirth","getFullYear","getMonth","getDate","email","setEmail","firstName","setFirstName","lastName","setLastName","gender","validGenders","isValidGender","indexOf","setGender","phone","setPhoneNumber","address","city","setHomeCity","country","setCountry","appBoyTraits","Object","entries","forEach","key","value","setCustomUserAttribute"],"mappings":"AAAA,OAAOA,WAAP,MAGO,yBAHP;AAMA,gBAAgBC,OAAD,IAAgC;AAC7C,MAAIA,OAAO,CAACC,MAAZ,EAAoB;AAClBF,IAAAA,WAAW,CAACG,UAAZ,CAAuBF,OAAO,CAACC,MAA/B;AACD;;AAED,MAAID,OAAO,CAACG,MAAR,CAAeC,QAAnB,EAA6B;AAC3B,UAAMC,IAAI,GAAG,IAAIC,IAAJ,CAASN,OAAO,CAACG,MAAR,CAAeC,QAAxB,CAAb;AACAL,IAAAA,WAAW,CAACQ,cAAZ,CACEF,IAAI,CAACG,WAAL,EADF,EAEE;AACCH,IAAAA,IAAI,CAACI,QAAL,KAAkB,CAHrB,EAIEJ,IAAI,CAACK,OAAL,EAJF;AAMD;;AAED,MAAIV,OAAO,CAACG,MAAR,CAAeQ,KAAnB,EAA0B;AACxBZ,IAAAA,WAAW,CAACa,QAAZ,CAAqBZ,OAAO,CAACG,MAAR,CAAeQ,KAApC;AACD;;AAED,MAAIX,OAAO,CAACG,MAAR,CAAeU,SAAnB,EAA8B;AAC5Bd,IAAAA,WAAW,CAACe,YAAZ,CAAyBd,OAAO,CAACG,MAAR,CAAeU,SAAxC;AACD;;AAED,MAAIb,OAAO,CAACG,MAAR,CAAeY,QAAnB,EAA6B;AAC3BhB,IAAAA,WAAW,CAACiB,WAAZ,CAAwBhB,OAAO,CAACG,MAAR,CAAeY,QAAvC;AACD;;AAED,MAAIf,OAAO,CAACG,MAAR,CAAec,MAAnB,EAA2B;AACzB,UAAMC,YAAY,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAArB;AACA,UAAMC,aAAa,GAAGD,YAAY,CAACE,OAAb,CAAqBpB,OAAO,CAACG,MAAR,CAAec,MAApC,IAA8C,CAAC,CAArE;;AACA,QAAIE,aAAJ,EAAmB;AACjBpB,MAAAA,WAAW,CAACsB,SAAZ,CACErB,OAAO,CAACG,MAAR,CAAec,MADjB;AAGD;AACF;;AAED,MAAIjB,OAAO,CAACG,MAAR,CAAemB,KAAnB,EAA0B;AACxBvB,IAAAA,WAAW,CAACwB,cAAZ,CAA2BvB,OAAO,CAACG,MAAR,CAAemB,KAA1C;AACD;;AAED,MAAItB,OAAO,CAACG,MAAR,CAAeqB,OAAnB,EAA4B;AAC1B,QAAIxB,OAAO,CAACG,MAAR,CAAeqB,OAAf,CAAuBC,IAA3B,EAAiC;AAC/B1B,MAAAA,WAAW,CAAC2B,WAAZ,CAAwB1B,OAAO,CAACG,MAAR,CAAeqB,OAAf,CAAuBC,IAA/C;AACD;;AACD,QAAIzB,OAAO,CAACG,MAAR,CAAeqB,OAAf,CAAuBG,OAA3B,EAAoC;AAClC5B,MAAAA,WAAW,CAAC6B,UAAZ,CAAuB5B,OAAO,CAACG,MAAR,CAAeqB,OAAf,CAAuBG,OAA9C;AACD;AACF;;AAED,QAAME,YAAY,GAAG,CACnB,UADmB,EAEnB,OAFmB,EAGnB,WAHmB,EAInB,UAJmB,EAKnB,QALmB,EAMnB,OANmB,EAOnB,SAPmB,CAArB;AAUAC,EAAAA,MAAM,CAACC,OAAP,CAAe/B,OAAO,CAACG,MAAvB,EAA+B6B,OAA/B,CAAuC,QAAkB;AAAA,QAAjB,CAACC,GAAD,EAAMC,KAAN,CAAiB;;AACvD,QAAIL,YAAY,CAACT,OAAb,CAAqBa,GAArB,IAA4B,CAAhC,EAAmC;AACjClC,MAAAA,WAAW,CAACoC,sBAAZ,CAAmCF,GAAnC,EAAwCC,KAAxC;AACD;AACF,GAJD;AAMA,SAAOlC,OAAP;AACD,CAnED","sourcesContent":["import ReactAppboy, {\n  GenderTypes,\n  MonthsAsNumber,\n} from 'react-native-appboy-sdk';\nimport type { IdentifyEventType } from '@segment/analytics-react-native';\n\nexport default (payload: IdentifyEventType) => {\n  if (payload.userId) {\n    ReactAppboy.changeUser(payload.userId);\n  }\n\n  if (payload.traits.birthday) {\n    const data = new Date(payload.traits.birthday);\n    ReactAppboy.setDateOfBirth(\n      data.getFullYear(),\n      // getMonth is zero indexed\n      (data.getMonth() + 1) as MonthsAsNumber,\n      data.getDate()\n    );\n  }\n\n  if (payload.traits.email) {\n    ReactAppboy.setEmail(payload.traits.email);\n  }\n\n  if (payload.traits.firstName) {\n    ReactAppboy.setFirstName(payload.traits.firstName);\n  }\n\n  if (payload.traits.lastName) {\n    ReactAppboy.setLastName(payload.traits.lastName);\n  }\n\n  if (payload.traits.gender) {\n    const validGenders = ['m', 'f', 'n', 'o', 'p', 'u'];\n    const isValidGender = validGenders.indexOf(payload.traits.gender) > -1;\n    if (isValidGender) {\n      ReactAppboy.setGender(\n        payload.traits.gender as GenderTypes[keyof GenderTypes]\n      );\n    }\n  }\n\n  if (payload.traits.phone) {\n    ReactAppboy.setPhoneNumber(payload.traits.phone);\n  }\n\n  if (payload.traits.address) {\n    if (payload.traits.address.city) {\n      ReactAppboy.setHomeCity(payload.traits.address.city);\n    }\n    if (payload.traits.address.country) {\n      ReactAppboy.setCountry(payload.traits.address.country);\n    }\n  }\n\n  const appBoyTraits = [\n    'birthday',\n    'email',\n    'firstName',\n    'lastName',\n    'gender',\n    'phone',\n    'address',\n  ];\n\n  Object.entries(payload.traits).forEach(([key, value]) => {\n    if (appBoyTraits.indexOf(key) < 0) {\n      ReactAppboy.setCustomUserAttribute(key, value as any);\n    }\n  });\n\n  return payload;\n};\n"]}