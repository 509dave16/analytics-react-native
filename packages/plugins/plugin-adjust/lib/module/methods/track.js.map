{"version":3,"sources":["track.ts"],"names":["Adjust","AdjustEvent","extract","mappedCustomEventToken","event","settings","anonId","anonymousId","length","addSessionPartnerParameter","token","adjEvent","properties","Object","entries","forEach","key","value","addCallbackParameter","revenue","currency","orderId","setRevenue","setTransactionId","trackEvent"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,WAAjB,QAAoC,qBAApC;AAKA,SAASC,OAAT,EAAkBC,sBAAlB,QAAgD,SAAhD;AAEA,gBAAe,CAACC,KAAD,EAAwBC,QAAxB,KAA4D;AACzE,QAAMC,MAAM,GAAGF,KAAK,CAACG,WAArB;;AACA,MAAID,MAAM,IAAIA,MAAM,CAACE,MAAP,GAAgB,CAA9B,EAAiC;AAC/BR,IAAAA,MAAM,CAACS,0BAAP,CAAkC,cAAlC,EAAkDH,MAAlD;AACD;;AAED,QAAMI,KAAK,GAAGP,sBAAsB,CAACC,KAAK,CAACA,KAAP,EAAcC,QAAd,CAApC;;AACA,MAAIK,KAAJ,EAAW;AACT,UAAMC,QAAQ,GAAG,IAAIV,WAAJ,CAAgBS,KAAhB,CAAjB;AAEA,UAAME,UAAU,GAAGR,KAAK,CAACQ,UAAzB;;AACA,QAAIA,UAAJ,EAAgB;AACdC,MAAAA,MAAM,CAACC,OAAP,CAAeF,UAAf,EAA2BG,OAA3B,CAAmC,QAAkB;AAAA,YAAjB,CAACC,GAAD,EAAMC,KAAN,CAAiB;AACnDN,QAAAA,QAAQ,CAACO,oBAAT,CAA8BF,GAA9B,EAAmCC,KAAnC;AACD,OAFD;AAIA,YAAME,OAAO,GAAGjB,OAAO,CAAS,SAAT,EAAoBU,UAApB,CAAvB;AACA,YAAMQ,QAAQ,GAAGlB,OAAO,CAAS,UAAT,EAAqBU,UAArB,EAAiC,KAAjC,CAAxB;AACA,YAAMS,OAAO,GAAGnB,OAAO,CAAS,SAAT,EAAoBU,UAApB,CAAvB;;AAEA,UAAIO,OAAO,IAAIC,QAAf,EAAyB;AACvBT,QAAAA,QAAQ,CAACW,UAAT,CAAoBH,OAApB,EAA6BC,QAA7B;AACD;;AAED,UAAIC,OAAJ,EAAa;AACXV,QAAAA,QAAQ,CAACY,gBAAT,CAA0BF,OAA1B;AACD;AACF;;AAEDrB,IAAAA,MAAM,CAACwB,UAAP,CAAkBb,QAAlB;AACD;AACF,CA/BD","sourcesContent":["import { Adjust, AdjustEvent } from 'react-native-adjust';\nimport type {\n  TrackEventType,\n  SegmentAdjustSettings,\n} from '@segment/analytics-react-native';\nimport { extract, mappedCustomEventToken } from '../util';\n\nexport default (event: TrackEventType, settings: SegmentAdjustSettings) => {\n  const anonId = event.anonymousId;\n  if (anonId && anonId.length > 0) {\n    Adjust.addSessionPartnerParameter('anonymous_id', anonId);\n  }\n\n  const token = mappedCustomEventToken(event.event, settings);\n  if (token) {\n    const adjEvent = new AdjustEvent(token);\n\n    const properties = event.properties;\n    if (properties) {\n      Object.entries(properties).forEach(([key, value]) => {\n        adjEvent.addCallbackParameter(key, value as string);\n      });\n\n      const revenue = extract<number>('revenue', properties);\n      const currency = extract<string>('currency', properties, 'USD');\n      const orderId = extract<string>('orderId', properties);\n\n      if (revenue && currency) {\n        adjEvent.setRevenue(revenue, currency);\n      }\n\n      if (orderId) {\n        adjEvent.setTransactionId(orderId);\n      }\n    }\n\n    Adjust.trackEvent(adjEvent);\n  }\n};\n"]}