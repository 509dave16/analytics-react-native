{"version":3,"sources":["api.ts"],"names":["Base64","batchApi","uploadEvents","config","events","requestUrl","proxy","fetch","method","body","JSON","stringify","batch","sentAt","Date","toISOString","writeKey","headers","encode"],"mappings":"AACA,SAASA,MAAT,QAAuB,WAAvB;AACA,SAASC,QAAT,QAAyB,aAAzB;AAEA,OAAO,MAAMC,YAAY,GAAG,cAMtB;AAAA,MAN6B;AACjCC,IAAAA,MADiC;AAEjCC,IAAAA;AAFiC,GAM7B;AACJ,QAAMC,UAAU,GAAGF,MAAM,CAACG,KAAP,IAAgBL,QAAnC;AACA,QAAMM,KAAK,CAACF,UAAD,EAAa;AACtBG,IAAAA,MAAM,EAAE,MADc;AAEtBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,KAAK,EAAER,MADY;AAEnBS,MAAAA,MAAM,EAAE,IAAIC,IAAJ,GAAWC,WAAX,EAFW;AAGnBC,MAAAA,QAAQ,EAAEb,MAAM,CAACa;AAHE,KAAf,CAFgB;AAOtBC,IAAAA,OAAO,EAAE;AACP,uBAAkB,SAAQjB,MAAM,CAACkB,MAAP,CAAe,GAAEf,MAAM,CAACa,QAAS,GAAjC,CAAqC,EADxD;AAEP,sBAAgB;AAFT;AAPa,GAAb,CAAX;AAYD,CApBM","sourcesContent":["import type { Config, SegmentEvent } from './types';\nimport { Base64 } from 'js-base64';\nimport { batchApi } from './constants';\n\nexport const uploadEvents = async ({\n  config,\n  events,\n}: {\n  config: Config;\n  events: SegmentEvent[];\n}) => {\n  const requestUrl = config.proxy || batchApi;\n  await fetch(requestUrl, {\n    method: 'POST',\n    body: JSON.stringify({\n      batch: events,\n      sentAt: new Date().toISOString(),\n      writeKey: config.writeKey,\n    }),\n    headers: {\n      'Authorization': `Basic ${Base64.encode(`${config.writeKey}:`)}`,\n      'Content-Type': 'text/plain',\n    },\n  });\n};\n"]}