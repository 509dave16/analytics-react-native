{"version":3,"sources":["client.tsx"],"names":["createClient","config","logger","debug","enable","disable","clientConfig","defaultConfig","segmentStore","SovranStorage","storeId","writeKey","storePersistor","client","SegmentClient","store","init","Context","AnalyticsProvider","children","useAnalytics","console","error","screen","track","identify","flush","group","alias","reset"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AACA;;AACA;;;;;;AAEO,MAAMA,YAAY,GAAIC,MAAD,IAAoB;AAC9C,QAAMC,MAAM,GAAG,2BAAf;;AACA,MAAI,QAAOD,MAAP,aAAOA,MAAP,uBAAOA,MAAM,CAAEE,KAAf,MAAyB,SAA7B,EAAwC;AACtC,QAAIF,MAAM,CAACE,KAAX,EAAkB;AAChBD,MAAAA,MAAM,CAACE,MAAP;AACD,KAFD,MAEO;AACLF,MAAAA,MAAM,CAACG,OAAP;AACD;AACF;;AACD,QAAMC,YAAY,GAAG,EAAE,GAAGC,wBAAL;AAAoB,OAAGN;AAAvB,GAArB;AAEA,QAAMO,YAAY,GAAG,IAAIC,sBAAJ,CAAkB;AACrCC,IAAAA,OAAO,EAAET,MAAM,CAACU,QADqB;AAErCC,IAAAA,cAAc,EAAEX,MAAM,CAACW;AAFc,GAAlB,CAArB;AAKA,QAAMC,MAAM,GAAG,IAAIC,wBAAJ,CAAkB;AAC/Bb,IAAAA,MAAM,EAAEK,YADuB;AAE/BJ,IAAAA,MAF+B;AAG/Ba,IAAAA,KAAK,EAAEP;AAHwB,GAAlB,CAAf;AAMAK,EAAAA,MAAM,CAACG,IAAP;AAEA,SAAOH,MAAP;AACD,CAzBM;;;AA2BP,MAAMI,OAAO,gBAAG,0BAAoC,IAApC,CAAhB;;AAEO,MAAMC,iBAAiB,GAAG,QAM3B;AAAA,MAN4B;AAChCL,IAAAA,MADgC;AAEhCM,IAAAA;AAFgC,GAM5B;;AACJ,MAAI,CAACN,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AAED,sBAAO,6BAAC,OAAD,CAAS,QAAT;AAAkB,IAAA,KAAK,EAAEA;AAAzB,KAAkCM,QAAlC,CAAP;AACD,CAZM;;;;AAcA,MAAMC,YAAY,GAAG,MAAqB;AAC/C,QAAMP,MAAM,GAAG,uBAAWI,OAAX,CAAf;;AACA,MAAI,CAACJ,MAAL,EAAa;AACXQ,IAAAA,OAAO,CAACC,KAAR,CACE,gCADF,EAEE,+FAFF,EADW,CAMX;;AACA,WAAO,EAAP;AACD;;AACD,SAAO;AACLC,IAAAA,MAAM,EAAE;AAAA,aAAaV,MAAM,CAACU,MAAP,CAAc,YAAd,CAAb;AAAA,KADH;AAELC,IAAAA,KAAK,EAAE;AAAA,aAAaX,MAAM,CAACW,KAAP,CAAa,YAAb,CAAb;AAAA,KAFF;AAGLC,IAAAA,QAAQ,EAAE;AAAA,aAAaZ,MAAM,CAACY,QAAP,CAAgB,YAAhB,CAAb;AAAA,KAHL;AAILC,IAAAA,KAAK,EAAE,MAAMb,MAAM,CAACa,KAAP,EAJR;AAKLC,IAAAA,KAAK,EAAE;AAAA,aAAad,MAAM,CAACc,KAAP,CAAa,YAAb,CAAb;AAAA,KALF;AAMLC,IAAAA,KAAK,EAAE;AAAA,aAAaf,MAAM,CAACe,KAAP,CAAa,YAAb,CAAb;AAAA,KANF;AAOLC,IAAAA,KAAK,EAAE;AAAA,aAAahB,MAAM,CAACgB,KAAP,CAAa,YAAb,CAAb;AAAA;AAPF,GAAP;AASD,CApBM","sourcesContent":["import React, { createContext, useContext } from 'react';\n\nimport { defaultConfig } from './constants';\nimport type { Config, ClientMethods } from './types';\nimport { createLogger } from './logger';\nimport { SegmentClient } from './analytics';\nimport { SovranStorage } from './storage';\n\nexport const createClient = (config: Config) => {\n  const logger = createLogger();\n  if (typeof config?.debug === 'boolean') {\n    if (config.debug) {\n      logger.enable();\n    } else {\n      logger.disable();\n    }\n  }\n  const clientConfig = { ...defaultConfig, ...config };\n\n  const segmentStore = new SovranStorage({\n    storeId: config.writeKey,\n    storePersistor: config.storePersistor,\n  });\n\n  const client = new SegmentClient({\n    config: clientConfig,\n    logger,\n    store: segmentStore,\n  });\n\n  client.init();\n\n  return client;\n};\n\nconst Context = createContext<SegmentClient | null>(null);\n\nexport const AnalyticsProvider = ({\n  client,\n  children,\n}: {\n  client?: SegmentClient;\n  children?: any;\n}) => {\n  if (!client) {\n    return null;\n  }\n\n  return <Context.Provider value={client}>{children}</Context.Provider>;\n};\n\nexport const useAnalytics = (): ClientMethods => {\n  const client = useContext(Context);\n  if (!client) {\n    console.error(\n      'Segment client not configured!',\n      'To use the useAnalytics() hook, pass an initialized Segment client into the AnalyticsProvider'\n    );\n\n    // @ts-ignore\n    return {};\n  }\n  return {\n    screen: (...args) => client.screen(...args),\n    track: (...args) => client.track(...args),\n    identify: (...args) => client.identify(...args),\n    flush: () => client.flush(),\n    group: (...args) => client.group(...args),\n    alias: (...args) => client.alias(...args),\n    reset: (...args) => client.reset(...args),\n  };\n};\n"]}